<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SPXVisuals</title>

<style>
body {
font-family: system-ui, sans-serif;
background: #0f172a;
color: #e5e7eb;
margin: 0;
padding: 24px;
}

a { text-decoration: none; color: inherit; }

/* ---------------- Header ---------------- */
header {
position: sticky;
top: 0;
z-index: 100;
padding: 16px 24px;
display: flex;
flex-direction: column;
align-items: center;
gap: 10px;
background: linear-gradient(90deg, #3b82f6, #06b6d4, #3b82f6);
background-size: 200% 200%;
animation: gradientShift 6s ease infinite;
color: #ffffff;
}

.header-watermark {
position: absolute;
right: 14px;
bottom: 6px;
font-size: 0.7rem;
opacity: 0.45;
pointer-events: none;
}

h1 {
margin: 0;
font-size: 2rem;
display: flex;
align-items: center;
gap: 12px;
}

.title-link,.x-link { color:#fff; cursor:pointer; }
.title-link:hover,.x-link:hover { text-decoration:underline; }

.controls {
display:flex;
flex-direction:column;
gap:10px;
width:100%;
max-width:420px;
align-items:center;
}

input[type="text"] {
padding:6px 12px;
border-radius:6px;
border:1px solid #475569;
background:#020617;
color:#e5e7eb;
width:100%;
max-width:360px;
text-align:center;
}

.filter-buttons {
display:flex;
gap:8px;
flex-wrap:wrap;
justify-content:center;
}

button {
background:#020617;
color:#e5e7eb;
border:none;
border-radius:6px;
padding:6px 12px;
cursor:pointer;
transition:background .3s,color .3s;
}

button:hover { background:#1e293b; }

button.active {
background:#ffffff;
color:#020617;
}

#clearSearch {
background:#111827;
display:none;
}

/* ---------------- Posts Layout ---------------- */
main {
display:grid;
grid-template-columns:repeat(2,1fr);
gap:32px;
margin-top:32px;
grid-auto-flow:dense;
}

.post {
width:100%;
margin-bottom:40px;
background:transparent;
padding:0;
transition:transform .35s ease,filter .35s ease;
}

.post:hover {
transform:scale(1.03);
filter:drop-shadow(0 14px 36px rgba(59,130,246,.4));
}

.post img {
width:100%;
border-radius:10px;
margin:16px 0;
cursor:zoom-in;
transition:transform .3s ease,box-shadow .3s ease;
}

.hashtags {
display:flex;
flex-wrap:wrap;
gap:6px;
margin-bottom:6px;
}

.hashtags a {
font-size:.85rem;
cursor:pointer;
color:#22d3ee;
animation:glowPulse 2.5s ease-in-out infinite alternate;
}

.post-date {
font-size:.8rem;
color:#94a3b8;
margin-bottom:6px;
}

.tweet-link-container {
text-align:center;
margin-bottom:8px;
}

.tweet-link-container a {
display:inline-block;
background:linear-gradient(90deg,#3b82f6,#06b6d4,#3b82f6);
background-size:200% 200%;
padding:6px 10px;
border-radius:8px;
font-weight:bold;
color:#fff;
animation:gradientShift 3s ease infinite;
transition:transform .3s;
}

.image-modal {
position:fixed;
inset:0;
background:rgba(0,0,0,.85);
display:flex;
align-items:center;
justify-content:center;
z-index:9999;
}

footer {
text-align:center;
font-size:.8rem;
color:#94a3b8;
margin-top:48px;
}

@media(max-width:768px){
main{grid-template-columns:1fr;}
}

@keyframes glowPulse {
from{text-shadow:0 0 6px #22d3ee;}
to{text-shadow:0 0 14px #3b82f6;}
}

@keyframes gradientShift {
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}
</style>
</head>

<body>
<header>
<div class="header-watermark">¬© SPXVisuals</div>

<h1>
<span>üìä</span>
<a href="https://spxvisuals.github.io/" class="title-link">SPXVisuals</a>
<span>üìà</span>
</h1>

<a href="https://x.com/SPXVisuals" target="_blank" class="x-link">ùïè</a>

<div class="controls">
<input type="text" id="search" placeholder="Search by hashtag or MM/DD/YYYY" />
<div class="filter-buttons">
<button id="todayFilter">Today's Charts</button>
<button id="weekFilter">This Week</button>
<button id="monthFilter">This Month</button>
<button id="clearSearch">Clear Search</button>
</div>
</div>
</header>

<main id="posts"></main>
<footer>¬© 2026 SPXVisuals ‚Äî All Rights Reserved</footer>

<script>
async function loadPosts(){
const indexRes=await fetch('output/metadata/index.json');
const files=await indexRes.json();
const all=[];
for(const file of files){
const res=await fetch(`output/metadata/${file}`);
const daily=await res.json();
const dateMatch=file.match(/\d{4}-\d{2}-\d{2}/);
const date=dateMatch?dateMatch[0]:'';
daily.forEach(p=>{
all.push({date,text:p.tweet_text,images:p.images,url:p.tweet_url,hashtags:extractHashtags(p.tweet_text)});
});
}
return all.sort((a,b)=>b.date.localeCompare(a.date));
}

function extractHashtags(t){return [...t.matchAll(/#[A-Za-z0-9_]+/g)].map(m=>m[0]);}

function todayLocalISO(){
const d=new Date();d.setHours(0,0,0,0);
return d.toISOString().slice(0,10);
}

function normalizeDateInput(i){
const m=i.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);
if(!m)return i;
return `${m[3]}-${m[1]}-${m[2]}`;
}

function renderPosts(posts){
const c=document.getElementById('posts');
c.innerHTML='';
posts.forEach(post=>{
const d=document.createElement('div');
d.className='post';
d.innerHTML=`
${post.url?`<div class="tweet-link-container"><a href="${post.url}" target="_blank">See Post On ùïè</a></div>`:''}
<div class="post-date">${post.date}</div>
<div class="hashtags">${post.hashtags.map(t=>`<a href="#">${t}</a>`).join('')}</div>
<div>${post.text}</div>
${post.images.map(i=>`<img src="${i}" loading="lazy">`).join('')}
`;
c.appendChild(d);
});
}

let allPosts=[];
const filters={today:false,week:false,month:false};

function applyFilters(){
let input=normalizeDateInput(document.getElementById('search').value.toLowerCase());
let filtered=allPosts.filter(p=>p.hashtags.some(t=>t.toLowerCase().includes(input))||p.date.includes(input));
const now=new Date(todayLocalISO());

if(filters.today)filtered=filtered.filter(p=>p.date===todayLocalISO());
if(filters.week){const d=new Date(now);d.setDate(now.getDate()-7);filtered=filtered.filter(p=>new Date(p.date)>=d);}
if(filters.month){const d=new Date(now);d.setMonth(now.getMonth()-1);filtered=filtered.filter(p=>new Date(p.date)>=d);}

renderPosts(filtered);
}

document.getElementById('search').oninput=applyFilters;
todayFilter.onclick=()=>{filters.today=!filters.today;filters.week=filters.month=false;applyFilters();};
weekFilter.onclick=()=>{filters.week=!filters.week;filters.today=filters.month=false;applyFilters();};
monthFilter.onclick=()=>{filters.month=!filters.month;filters.today=filters.week=false;applyFilters();};
clearSearch.onclick=()=>{search.value='';filters.today=filters.week=filters.month=false;renderPosts(allPosts);};

loadPosts().then(p=>{allPosts=p;renderPosts(allPosts);});
</script>

</body>
</html>
