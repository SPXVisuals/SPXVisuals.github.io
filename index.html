<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SPXVisuals</title>

<style>
/* ---------------- Base Styles ---------------- */
body {
font-family: system-ui, sans-serif;
background: #0f172a;
color: #e5e7eb;
margin: 0;
padding: 24px;
}

a { text-decoration: none; color: inherit; }

/* ---------------- Header ---------------- */
header {
position: sticky;
top: 0;
z-index: 100;
padding: 16px 24px;
display: flex;
flex-direction: column;
align-items: center;
gap: 10px;
background: linear-gradient(90deg, #3b82f6, #06b6d4, #3b82f6);
background-size: 200% 200%;
animation: gradientShift 6s ease infinite;
color: #ffffff;
}

h1 {
margin: 0;
font-size: 2rem;
display: flex;
align-items: center;
gap: 12px;
}

.title-link, .x-link { color: #ffffff; cursor: pointer; }
.title-link:hover, .x-link:hover { text-decoration: underline; }

.header-icons { font-size: 1.5rem; }
.x-link { font-size: 1.2rem; margin-top: -4px; }

/* ---------------- Controls ---------------- */
.controls {
display: flex;
flex-direction: column;
gap: 10px;
width: 100%;
max-width: 420px;
align-items: center;
}

input[type="text"] {
padding: 6px 12px;
border-radius: 6px;
border: 1px solid #475569;
background: #020617;
color: #e5e7eb;
width: 100%;
max-width: 360px;
text-align: center;
}

.filter-buttons {
display: flex;
gap: 8px;
flex-wrap: wrap;
justify-content: center;
}

button {
background: #020617;
color: #e5e7eb;
border: none;
border-radius: 6px;
padding: 6px 12px;
cursor: pointer;
transition: background 0.3s;
}

button:hover { background: #1e293b; }
button.active { background: #3b82f6; }

#clearSearch {
background: #111827;
display: none;
}

/* ---------------- Posts Layout ---------------- */
main {
position: relative;
margin-top: 32px;
}

.post {
width: 100%;
margin-bottom: 40px;
break-inside: avoid;
transition: transform 0.35s ease, filter 0.35s ease;
}

.post:hover {
transform: scale(1.03);
filter: drop-shadow(0 14px 36px rgba(59,130,246,0.4));
}

.post img {
width: 100%;
border-radius: 10px;
margin: 16px 0;
cursor: zoom-in;
transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.post img:hover {
transform: scale(1.02);
box-shadow: 0 0 26px rgba(34,211,238,0.45);
}

.hashtags { display: flex; flex-wrap: wrap; gap: 6px; }
.hashtags a { font-size: .85rem; color:#22d3ee; }

.post-date { font-size:.8rem; color:#94a3b8; }

.tweet-link-container {
text-align:center;
margin-bottom:8px;
}

.tweet-link-container a {
display:inline-block;
background: linear-gradient(90deg,#3b82f6,#06b6d4,#3b82f6);
background-size:200% 200%;
padding:6px 10px;
border-radius:8px;
font-weight:bold;
color:#fff;
animation:gradientShift 3s ease infinite;
transition:transform .3s;
}

.tweet-link-container a:hover { transform:scale(1.08); }

.image-modal {
position:fixed;
inset:0;
background:rgba(0,0,0,.85);
display:flex;
align-items:center;
justify-content:center;
z-index:9999;
}

.image-modal img {
max-width:95%;
max-height:95%;
border-radius:12px;
cursor:zoom-out;
}

@keyframes gradientShift {
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}
</style>
</head>

<body>

<header>
<h1>
<span class="header-icons">üìä</span>
<a href="https://spxvisuals.github.io/" class="title-link">SPXVisuals</a>
<span class="header-icons">üìà</span>
</h1>

<a href="https://x.com/SPXVisuals" class="x-link">ùïè</a>

<div class="controls">
<input type="text" id="search" placeholder="Search by hashtag or MM/DD/YYYY" />
<div class="filter-buttons">
<button id="todayFilter">Today's Charts</button>
<button id="weekFilter">This Week</button>
<button id="monthFilter">This Month</button>
<button id="clearSearch">Clear</button>
</div>
</div>
</header>

<main id="posts"></main>

<script>
async function loadPosts() {
const indexRes = await fetch('output/metadata/index.json');
const files = await indexRes.json();
const all = [];

for (const file of files) {
const res = await fetch(`output/metadata/${file}`);
const daily = await res.json();

const dateMatch = file.match(/\d{4}-\d{2}-\d{2}/);
const date = dateMatch ? dateMatch[0] : '';

daily.forEach(p => {
all.push({
date,
text: p.tweet_text,
images: p.images,
url: p.tweet_url,
hashtags: extractHashtags(p.tweet_text)
});
});
}

return all.sort((a,b)=>b.date.localeCompare(a.date));
}

function extractHashtags(text){
return [...text.matchAll(/#[A-Za-z0-9_]+/g)].map(m=>m[0]);
}

function renderPosts(posts){
const container=document.getElementById('posts');
container.innerHTML='';

posts.forEach(post=>{
const div=document.createElement('div');
div.className='post';

div.innerHTML=`
${post.url?`<div class="tweet-link-container"><a href="${post.url}" target="_blank">See Post On ùïè</a></div>`:''}
<div class="post-date">${post.date}</div>
<div class="hashtags">${post.hashtags.map(t=>`<a href="#">${t}</a>`).join('')}</div>
<div>${post.text}</div>
${post.images.map(i=>`<img src="${i}" loading="lazy">`).join('')}
`;

container.appendChild(div);
});

waitForImages();
}

function applyMasonry(){
const container=document.getElementById('posts');
const items=[...container.children];
if(!items.length) return;

const cols=window.innerWidth<768?1:2;
const gap=32;
const heights=Array(cols).fill(0);
const colWidth=(container.clientWidth-gap)/cols;

container.style.position='relative';

items.forEach(item=>{
item.style.position='absolute';
item.style.width=colWidth+'px';

const col=heights.indexOf(Math.min(...heights));
const x=col*(colWidth+gap);
const y=heights[col];

item.style.left=x+'px';
item.style.top=y+'px';

heights[col]+=item.offsetHeight+gap;
});

container.style.height=Math.max(...heights)+'px';
}

function waitForImages(){
const imgs=document.querySelectorAll('#posts img');
let loaded=0;
if(!imgs.length){applyMasonry();return;}

imgs.forEach(img=>{
if(img.complete){
if(++loaded===imgs.length) applyMasonry();
}else{
img.onload=img.onerror=()=>{ if(++loaded===imgs.length) applyMasonry(); };
}
});
}

window.addEventListener('resize', waitForImages);

loadPosts().then(posts=>renderPosts(posts));
</script>

<script>
document.addEventListener('click',e=>{
if(e.target.tagName==='IMG'&&e.target.closest('.post')){
const modal=document.createElement('div');
modal.className='image-modal';
modal.innerHTML=`<img src="${e.target.src}">`;
modal.onclick=()=>modal.remove();
document.body.appendChild(modal);
}
});
</script>

</body>
</html>
